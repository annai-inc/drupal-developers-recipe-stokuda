---
marp: true
theme: gaia
_class: invert
---

<!-- _class: lead -->
# Drupalの開発ツール

---

このセクションでは、開発プロセスを簡素化または合理化するツールを紹介します。

---

## Drupalの実行環境

次のセクションからは、実際にDrupalを動かしコードを書いていきます。そのため、今後はDrupalを稼働させるための環境や、IDE・エディタ等が必要になります。

以降に、用途やケースごとにいくつか代表的なツールを紹介します。実際の導入する場合の詳細な情報は、リンク先を参照してください。

---

### ACQUIA DEV DESKTOP

もし、スキル的にローカル環境の構築が難しい場合は、[Acquia](http://acquia.com) が提供している[https://www.acquia.com/jp/drupal/acquia-dev-desktop](ACQUIA DEV DESKTOP) が利用できます。これは、Windows、Linux、またはMacOSでDrupalを動かすためのアプリケーションスタック全体を提供します。

---

### DrupalVM

ACQUIA DEV DESKTOPは導入は簡単ですが、ホストOS上で直接アプリケーションスタックを動かします。このような方法が好みではない場合、Drupalに対応したVagrantおよびAnsibleベースのローカル開発環境である [Drupal VM](https://www.drupalvm.com) の導入を検討してください。

(なお、DrupalVMではDockerも利用可能です)

---

### docker4drupal

実行環境が異なる複数のアプリケーションを同時に扱いような場合、仮想マシンを使うとメンテナンスが煩雑になります。このような場合は、Dockerベースの開発環境の導入を検討してください。

[wodby](https://wodby.com/) が提供している [docker4drupal](https://github.com/wodby/docker4drupal) は非常に柔軟なスタック構成であり、ドキュメントも豊富です。

---

### Create your own stack!

現代の開発環境としては、メンテナンス性、柔軟性、フットプリント等を考えるとDockerが最も優れた選択肢です。このセクションで紹介したもの以外にも、github上でDrupalやLAMPスタック向けのDockerを使ったプロジェクトを多数見つけることができます。

また、プロジェクトやチームで採用されている標準の開発環境や、生産性の高いエンジニアが利用している環境からの学びは非常に重要です。

最終的には、自身の好みやタスクにフィットする開発環境を自分で作ることをお勧めします。

---

## IDE、エディタ

どんなツールでもDrupalの開発は可能ですが、 [PHPStorm](https://www.jetbrains.com/phpstorm/) が最も初期設定の手間がかかりません。

Drupal向けのプラグインが提供されていたり、Docker環境との接続も標準でサポートされています。

また、PHPデバッガーを実行する必要はありませんが、XdebugまたはZend Debuggerを実行できると便利です。

デバッグだけでなくコードリーディングのためにも、PHPデバッガーの利用をお勧めします。

---

## バージョン管理

現代のソフトウェア開発はバージョン管理された環境で行う必要があり、Drupalではgitが採用されています。本コンテンツのサンプルコードを取得するためにも、ローカル環境にgitが必要になります。

また、プロジェクトにより [github-flow](http://scottchacon.com/2011/08/31/github-flow.html) や [git-flow](https://danielkummer.github.io/git-flow-cheatsheet/index.html) を採用している場合は、これらのフローを支援するツールの使い方やフローの理解も必要になります。

---

## Composer

以前のセクションで紹介したように、Drupal 8のインストールはComposerテンプレートを介して行うのが最適です。ですが、[Drupal.orgのgitリポジトリから直接インストールする](https://www.drupal.org/project/drupal/git-instructions)こともできます。

どちらの方法でインストールするにせよ、Composer使って依存するライブラリをインストールする必要があります。そのため、Composerの基本的な使用方法を理解しておきましょう。

---

## APIドキュメントとコーディング標準

どんな言語やフレームワークであれ、優れたコードを作成するには多くの背景知識が必要です(もちろん、本コンテンツ目的も可能な限り多くの背景知識を提供することです)。

---

### APIドキュメント

DrupalのAPIドキュメントは https://api.drupal.org/api/drupal に公開されています。これらのほぼ全ては、[Doxygen](http://www.doxygen.nl/) を利用して個度に埋め込まれたコメントから生成されています。

---

### コーディング標準

ソフトウェア開発のベストプラクティスには、コードをクリーンで、一貫性のある、読みやすいものにすることが含まれます。

この1つの側面は、コーディング標準に従うことにより、コードのフォーマットの微妙な違いを取り除くことです。

これは、何千人もの開発者がコードに貢献しているDrupalなどのプラットフォームでは特に重要です(もちろん、例えあなた一人のプライベートプロジェクトであっても重要です！)。

コーディング標準がなければ、貴重な開発時間を開発に取り組むのではなく、単にコードを解読することに費やさすことになります。

---

Drupal関するコーディング標準は https://www.drupal.org/docs/develop/standards/coding-standards を参照してください。

エディタやIDEの機能を利用して、コードのフォーマットに関する問題を自動的に検出できるようにしておきましょう。

---

### Drupalのバージョン毎の変更点

Drupalのバージョン毎の変更点は https://www.drupal.org/list-changes/drupal で調べることができます。

このリソースは、Drupal 7の開発者がDrupal 8で初めて開発する場合や、Drupal 8のマイナーバージョン毎の機能の違いを把握する場合に役立ちます。

---

## Develモジュール

開発環境に [Devel](http://drupal.org/project/devel) モジュールを導入すると便利です。これには、開発者がDrupalコードを作成およびデバッグできるように設計されたいくつかのツールが含まれています。

- オブジェクトと配列をフォーマットされたDrupal出力にダンプするために使用される関数
- データベースの使用率とパフォーマンスを分析するためのツール
- サイトにテストデータをすばやく投入するためのコンテンツジェネレーター

---

残念な事に、この機能はコアには含まれていないため、composerで別途インストールする必要があります。

---

## Drush (the Drupal Shell)

場合によっては、コンソールで1つのコマンドでいくつかのタスクを実行する方がはるかに簡単です。

[Drush](http://drupal.org/project/drush) はコマンドラインDrupalインターフェイスを提供し、コンソールで数回のキーストロークでタスクを実行するために使用できます。

開発時には、キャッシュのクリア、特定のタスクの実行、またはリモートサーバーの展開が必要になることがよくあります。Drushは、このようなタスクを達成するのに役立ちます。

さらに、たとえばcronジョブで使用されるさまざまなカスタムタスクを実行する独自のDrushコマンドを作ること等もできます。

---

残念な事に、この機能もコアには含まれていないため、composerで別途インストールする必要があります。

ただし、[Composer template](https://github.com/drupal-composer/drupal-project) を使ってインストールした場合には最初から含まれています。

---


## DrupalConsole

Drupal 8からはDrupalConsoleというCLIツールも開発されました。

Drushと重複する機能も多数ありますが、こちらはより開発者向けツールとなっており、ボイラプレートコードの生成などをサポートします。これは非常に強力な機能なので実際の開発では活用することをお勧めします。

---

しかし、実際に生成されるコードが何をするかを理解せずに使用する場合は注意が必要です。

自分がやっていることを理解するよう常に努力し、Stack Overflowや他のリソースからコードを盲目的にコピーして貼り付けることだけは絶対に止めましょう。

DrupalConsoleの代表的な使い方については、本コンテンツで随時紹介します。

---

## 開発環境用の設定

ローカル環境で開発を行うときは、デバッグ機能を有効にしたりキャッシュ機能を無効化すると効率的です。

これらの設定のサンプルは、`sites/example.settings.local.php` にあります。

キャッシュを常に無効にして開発することにより、キャッシュを有効にすると適切に機能しない特定の側面を見落とす危険性があることに注意してください。したがって、これらの設定のオン・オフは実施する開発やタスクの条件に応じて適切に変更すべきです。
